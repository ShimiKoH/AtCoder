## [AtCoder Beginner Contest 129_D Lamp](https://atcoder.jp/contests/abc129/tasks/abc129_d)

## 問題
縦 $H$ 行横 $W$ 列のグリッドが与えられる。このグリッドのうち、いくつかのマスには障害物が存在する。
すぬけ君は、障害物のないマスのうち一つを選び、そのマスに灯を設置しようとしている。設置されたマスカラ上下左右の四方向にまっすぐに光線が伸びる。それぞれの方向について、最初に障害物が存在するマスまで照らされる。明かりを設置したマスも照らされるが、障害物が存在するマスは照らされない。
すぬけ君は明かりによって照らされるマスの個数を最大化したいと考えている。
$H$ 個の長さ $W$ の文字列 $S_i(1 \leqq i \leqq H)$ が与えらえる。 $S_i$ の $j$ 文字列目 $(1 \leqq j \leqq W)$ が`#`のとき、グリッドの上から $i$ 行目で左から $j$ 列目のマスには障害物があり、`.`のときは障害物がない。
照らされるマスの個数の最大値を求めなさい。

## 制約
- $1 \leqq H \leqq 2,000$
- $1 \leqq W \leqq 2,000$
- $S_i$ は`#`と`.`のみからなる長さ $W$ の文字列
- $S_i(1 \leqq i \leqq H)$ のうちいずれかに`.`は最低 $1$ つ存在する

## 入力
入力は以下の景気で標準入力から与えられる。
```math
\begin{matrix} H & W \\
S_1 \\
\vdots \\
S_H \\
\end{matrix}
```

## 出力
照らされるマスの個数の最大値を出力せよ。

***

## 解き方
1. 任意の座標について、上下左右の探索は最大で
    - $H + W$ で $\mathcal{O}(H + W)$ 。
    - 明かりを置く座標の探索に $\mathcal{O}(HW)$ 。

    総計算量は $\mathcal{O}(HW(H + W))$ 、 最大で $\mathcal{O}(1.6 \times 10^{10})$ これはかなり遅い。

2. 行と列ごとに、連続して`.`が続いている数を数える。  
その後、明かりを置く座標について、記録した数を処理する。  
    - 数を数えるのに $\mathcal{O}(HW)$  
    - 明かりを置く位置の探索で $\mathcal{O}(HW)$  

    この $2$ つは独立なので、総計算量オーダーは $\mathcal{O}(HW)$ 、最大で $\mathcal{O}(4 \times 10^6)$  
    ただ、この方法では、記録段階で、横に数えて横に記録、縦に数えて縦に記録、といった具合に、追加で $H$ または $W$ が加算され、結果的に $2^k (k \sim 3,4)$ を掛けた計算量を必要とする。

3. 行と列ごとに、`#`が現れた箇所を配列に記録。  
その後、明かりを置く座標を走査する。  
任意の座標に対して、明かりの照らす範囲を二分探索によって求める。先ほど記録した配列の隣り合う座標の間はすべて`.`であるから、明かりを置く位置がどの隣り合う座標に挟まれるかを二分探索によって探索する。  
例 `#`の座標が $[0, 3, 4, 5, 9, 12]$ であり、$8$ に明かりを置いたとする。 $8$ は区間 $(5, 9)$ に属するため、この間の距離 $9-5-1$ がこの明かりが照らす範囲の広さである。  
    - すべての`#`の現れる箇所を探すのに $\mathcal{O}(HW)$
    - 任意の座標に対して、照らす範囲を探すのに $\mathcal{O}(\log H + \log W)$
    - 明かりを置く座標の走査に $\mathcal{O}(HW)$

    総計算量は $\mathcal{O}(HW(\log H + \log W))$ 
    最大で $\mathcal{O}(8.8 \times 10^7)$

    なお、この方法を採用する場合変にlistでitratorを回すより素直にvectorで探索したほうが早い


***この計算量比較については要検証***

## コード
### [C++](abc129_d.cpp) <span style="font-size:80%; font-weight:5">解法3</span>
### [C++ <span style="font-size:80%">実行時間エラー</span>](abc129_d_2.cpp) <span style="font-size:80%; font-weight:5">解法2</span>