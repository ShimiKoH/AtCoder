## [AtCoder Beginner Contest 195_E Lucky 7 Battle](https://atcoder.jp/contests/abc195/tasks/abc195_e)

## 問題
`0`,...,`9`からなる長さ $N$ の文字列 $S$ と、`A`,`T`からなる長さ $N$ の文字列 $X$ が与えられる。また、空文字列で初期化された $T$ がある。  
高橋くんと青木君がこれらを使ってゲームをする。ゲームは $N$ ラウンドからなり、 $i$ 回目 $(1 \leqq i \leqq N)$ のラウンドでは、次の操作が行われる。
- $X_i$ が`A`なら青木君が、`T`なら高橋君が以下の操作を行う
- 操作： $T$ の末尾に $S_i$ か`0`のどちらか一方を加える

$N$ 回の操作が終了した後、 $T$ は`0`,...,`9`からなる長さ $N$ の文字列となる。 $T$ を(先頭の余計な $0$ を取り除いたうえで) $10$ 進法で表された数と解釈したとき、 $7$ の倍数であれば高橋君の価値であり、そうでなければ青木君の勝ちである。  
$2$ 人が最適に行動するとき、どちらが勝つか判定せよ。

## 制約
- $1 \leqq N \leqq 2 \times 10^5$
- $S,X$ の長さは $N$
- $S$ は`0`,...,`9`のみからなる
- $X$ は`A`,`T`のみからなる

## 入力
入力は以下の形式で標準入力から与えられる。

$$
\begin{matrix}
N \\
S \\
X \\
\end{matrix}
$$

## 出力
$2$ 人が最適に行動するとき、高橋君が勝つなら `Takahashi`、青木君が勝つなら `Aoki` と出力せよ。

## 解き方
以下、断りがない場合、「あまり」とは、 $7$ で割った際の剰余であることを意味する。

高橋の手番になった際に、青木の操作によらず勝ち確に持ち込めるか？  
$\rightarrow$ 毎手番終了時に、それまでの文字列で作られる数字のあまりが、何であれば高橋が勝つのか？  
例えば、ある手番で高橋が ${0,5}$ から $1$ つを追加した際の数のあまりが ${2,6}$ であるときに高橋が勝つことが分かっている場合、

$$
\begin{align*}
&(&r \times 10 + 0 &\equiv 2 &&\lor & r \times 10 + 0 & \equiv 6) \ \lor \ (& r \times 10 + 5 &\equiv 2 &&\lor & r \times 10 + 5 & \equiv 6) \\
&(&r &\equiv 3 &&\lor & r & \equiv2 ) \ \lor \ ( & r &\equiv 6 &&\lor & r & \equiv 5) \\
\end{align*}
$$

つまり、高橋の手番直前の数のあまりが $2,3,5,6$ のいずれかであるときに高橋が勝つ。  
一方で、ある手番で青木が ${0,5}$ から $1$ つを追加した数のあまりが ${2,4}$ であるときに高橋が勝つことが分かっている場合、

$$
\begin{align*}
&(& r \times 10 + 0 & \equiv 2 &&\lor & r \times 10 + 0 & \equiv 4) \ \land \ (& r \times 10 + 5 & \equiv 2 && \lor & r \times 10 + 5 & \equiv 4) \\
&(& r & \equiv 3 && \lor & r & \equiv 6) \ \land \ (& r & \equiv 6 && \lor & r & \equiv 2)
\end{align*}
$$

つまり、青木の手番直前の数のあまりが $6$ であるときに、青木がどちらを選ぼうとも、高橋が勝つ。

このことから、以下の方法で動的計画を行う
1. $dp[k]$ という配列は、 $k$ 手番終了時に高橋が勝つことが確定するようなあまりの集合
2. $dp[k]$ から $dp[k-1]$ を求めるために、以下の式を用意する。

$$
\begin{cases}
r_{k - 1} \times 10 + 0 & \equiv r_k \\
r_{k - 1} \times 10 + S_k & \equiv r_k^{\prime}
\end{cases}
$$ 

3.  - $X_{k-1}$ が `T` のとき、 $2$ の式のどちらか一方が真であるような $r_{k - 1}$ の集合
    - $X_{k-1}$ が `A` のとき、 $2$ の式がともに真であるような $r_{k - 1}$ の集合

4. 最終的に $dp[0]$ に $0$ が含まれていれば、高橋の勝ちである。

## 計算量
- 文字列を辿るのに $\mathcal{O}(N)$
- $r_{k-1}$ の候補 $7$ 個それぞれで、判定に最大で $\mathcal{O}(7)$ (定数時間)

総計算量は $\mathcal{O}(N)$ のオーダー

あらかじめ $r_k$ と $S_k$ に対応する $r_{k - 1}$ を用意したほうが速いかと思ったけどそうでもないっぽい。

## コード
### [C++](abc195_e.cpp)  
### [C++ <span style="font-size: 70%">あらかじめ配列を作った場合(たいして速くない)</span>](abc195_e-2.cpp)