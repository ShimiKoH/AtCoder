# グラフ理論
## 序論
グラフ理論とは、**[頂点](#頂点-vertex)** と **[辺](#辺-edge)** の集合によって構成されるグラフに関する数学の理論である。

## AtCoder を解く際に必要になった証明問題
<details>
<summary><b>木の性質「閉路を持たない」</b></summary>

#### 問題
以下のようなグラフを考える。
- $N$ 個の頂点と、$N-1$個の辺によって構成される。
- **[連結](#連結-connected)** である。

**このとき、グラフが **[閉路](#閉路-cycle)** を持たないことを示せ。**
#### 解答
数学的帰納法によって証明する。
$2$つの小命題を以下のように定義し、それらが真であることを証明する。
1. 「$2$個の頂点と$1$個の辺によって構成されるグラフは閉路を持たない。」
これは単一の辺しか存在せず、明らかに閉路を持たない。
<br>
2. 「$k$個の頂点の$k-1$個の辺によって構成されるグラフが閉路を持たないとき、$k+1$個の頂点と$k$個の辺によって構成されるグラフは閉路を持たない。」
グラフは連結していなければならない。
$k$個の頂点から任意の$1$点を選び、辺を追加する。その辺の先に新たな頂点を$1$個追加する。
こうすることで、条件を満たしつつ、頂点と辺を$1$つずつ付け加えることができる。

以上、小命題1,2が証明されたので、帰納的に任意の $n(n = 1,2,\dots,k,\dots)$ についても閉路を持たないことが示された。
なお、このような特徴のグラフを **[木](#木-tree)** と呼ぶ。

</details>
<br>
<details>
<summary><b>木の直径の求め方</b></summary>

#### 問題
あるグラフが木であるとき、以下の語彙を定義する。
- 距離
任意の$2$つの頂点を指定したとき、その道に含まれる辺の数
(重み付きの場合は辺の重みの総和)。
- 直径
任意の$2$頂点間の距離のうち、最大のもの。

このとき、以下の方法で求めた距離が、直径であることを示せ。
1. 任意の頂点$v_a$から、最も距離の遠い頂点を$v_b$とする。
2. $v_b$から、最も距離の遠い頂点を$v_c$とする。
3. $2$点、$v_b, v_c$ の距離が直径である。

#### 解答
便宜上、以下の変数を用意する。
- $R(n, m): v_n, v_m$をつなぐ道
- $d(n, m): R(n, m)$ の距離

また、$2$点 $v_x, v_y$を以下の通りに仮定する。
- $d(x, y)$ は、他の任意の$2$点$v_i, v_j$間の距離$d(i,j)$よりも長い。
- $x_i, v_i$ は、$v_a, v_b, v_c$ のいずれとも異なる。

言い換えれば、木の直径は、$R(b, c)$ によって構成されるのではなく、$R(x, y)$ が本来の直径として存在していることを仮定したのである。

グラフは木であるため、任意の$2$頂点間には道がただ1つ存在することを踏まえ、以下の定数を新たに定義する。
- $R_{mid}: R(b,c), R(x,y)$ をつなぐ唯一の道
これが唯一しかないことは、閉路を持たないことによって証明される。
また、$R(b, c), R(x, y)$ が交差する場合は、$R_{mid}$ は長さを持たない道とする。
- $d_{mid}: R_{mid}$ の長さ
- $v_P: R(a,b)$上にあり、$R_{mid}$ の端点である頂点
- $v_Q: R(x,y)$上にあり、$R_{mid}$ の端点である頂点

つまり、 $R_{mid} = R(P, Q)$ 、$d_{mid} = d(P,Q)$ である。
<details>
<summary>略図</summary>

![graphic_theory_question2_1.jpg](https://github.com/ShimiKoH/AtCoder/blob/ba4efd940c76f3926c0dacb2519b0d2791ac3ff0/images/graphc_theory_question2_1.jpg)

なお、$v_a$ はいずれかの道の上またはそこからの分岐の先にある。
ただし、$v_b, v_c, v_x, v_y$の$4$端点のさらに先にはなにも存在しない。
(容易に最長であることに矛盾が生じるため。)
</details>

このとき、$v_x, v_y$ の存在および、$v_a, v_b, v_c$ の条件より、
$$
\begin{gather}
d(b, x) \leqq d(b, c)\\
\end{gather}
$$
また、それぞれの長さから、
$$
\begin{align}
d(b, c) & = d(b, P) + d(P, c) \\
d(b, x) & = d(b, P) + d_{mid} + d(Q, x) \\
d(c, y) & = d(c, P) + d_{mid} + d(Q, y)
\end{align}
$$
$(1), (2), (3)$ より、
$$
\begin{equation}
\begin{align*}
d(b, x) & \leqq d(b, c) \\
d(b, P) + d_{mid} + d(Q, x) & \leqq d(b, P) + d(P, c) \\
d(Q, x) & \leqq d(P, c) - d_{mid} \\
\end{align*}
\end{equation}
$$
また、定義より、
$$
\begin{align}
d_{mid} \geqq 0
\end{align}
$$
$(4), (5), (6)$ より、
$$
\begin{equation}
\begin{align*}
d(Q,x) & \leqq d(P, c) - d_{mid} \\
d(Q, x) & \leqq d(P, c) - d_{mid} + 2 \cdot d_{mid} \\
d(Q, x) & \leqq d(P, c) + d_{mid} \\
d(Q, x) + d(Q, y) & \leqq d(P, c) + d_{mid} + d(Q, y) \\
d(x, y) & \leqq d(c, y)
\end{align*}
\end{equation}
$$
$R(x, y)$ よりも、$R(c, y)$ の方が長いという結果が得られた。
しかしこれは、$v_x, v_y$ の存在を仮定した際の、
「$d(x, y)$ は、他の任意の$2$点$v_i, v_j$間の距離$d(i,j)$よりも長い。」
に矛盾している。
よって、仮定が偽であることが示され、木の直径は$d(b, c)$によって求められることが証明された。

</details>

## 用語解説
##### 頂点 vertex
海に浮かぶ島のようなもの。ノード <i>node</i>とも呼ばれる。
##### 辺 edge
島をつなぐ橋のようなもの。エッジ、節とも呼ばれる。
##### 連結 connected
グラフに含まれる任意の$2$つのエッジに道が存在していること。
##### 閉路 cycle
始点と終点が同じ道であるような(部分)グラフ。
##### 木 tree
連結であり、かつ、閉路を持たないグラフ。